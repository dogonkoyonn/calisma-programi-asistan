<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Manager - GÃ¼nlÃ¼k YaÅŸam YÃ¶neticisi</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="GÃ¼nlÃ¼k yaÅŸamÄ±nÄ± organize et! GÃ¶revler, Ã§alÄ±ÅŸma programlarÄ±, saÄŸlÄ±k takibi ve harcamalarÄ±nÄ± tek yerden yÃ¶net.">
    <meta name="theme-color" content="#667eea">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Life Manager">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="icons/icon.svg">
    <link rel="apple-touch-icon" href="icons/icon.svg">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/program-panel-styles.css">
    <link rel="stylesheet" href="css/wizard-styles.css">
    <link rel="stylesheet" href="css/magnetic-tilt.css">
    <link rel="stylesheet" href="css/settings-panel.css">
    <link rel="stylesheet" href="css/program-dashboard.css">
    <link rel="stylesheet" href="css/session-styles.css">
    <link rel="stylesheet" href="css/timer-styles.css">
    <link rel="stylesheet" href="css/daily-log-styles.css">
    <link rel="stylesheet" href="css/badges-styles.css">
    <link rel="stylesheet" href="css/theme-styles.css">
    <link rel="stylesheet" href="css/notification-dialog.css">
    <link rel="stylesheet" href="css/calendar-view.css">
    <!-- Yeni stiller -->
    <link rel="stylesheet" href="css/hamburger-menu.css">
    <link rel="stylesheet" href="css/todo-styles.css">
    <link rel="stylesheet" href="css/auth-styles.css">
    <link rel="stylesheet" href="css/onboarding-styles.css">
    <link rel="stylesheet" href="css/sync-indicator.css">
    <link rel="stylesheet" href="css/health-styles.css">
    <link rel="stylesheet" href="css/expense-styles.css">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Loading Spinner (early load) -->
    <script src="js/loading-spinner.js"></script>
</head>
<body>
    <!-- Hamburger Toggle (Mobil iÃ§in) -->
    <button class="hamburger-toggle" id="hamburgerToggle">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">âœ¨</div>
                    <div class="logo-text">
                        <h2>Life Manager</h2>
                        <span>GÃ¼nlÃ¼k YaÅŸam YÃ¶neticisi</span>
                    </div>
                </div>
            </div>

            <!-- Ana Navigasyon - Kategoriler -->
            <nav class="main-nav" id="mainNav">
                <button class="nav-item active" data-category="home">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-text">Ana Sayfa</span>
                </button>
                <button class="nav-item" data-category="study">
                    <span class="nav-icon">ğŸ“š</span>
                    <span class="nav-text">Ã‡alÄ±ÅŸma</span>
                    <span class="badge" style="display: none; background: #667eea">0</span>
                </button>
                <button class="nav-item" data-category="personal">
                    <span class="nav-icon">âœ…</span>
                    <span class="nav-text">GÃ¶revler</span>
                    <span class="badge" style="display: none; background: #4ECDC4">0</span>
                </button>
                <button class="nav-item" data-category="health">
                    <span class="nav-icon">ğŸ’Š</span>
                    <span class="nav-text">SaÄŸlÄ±k</span>
                    <span class="badge" style="display: none; background: #FF6B6B">0</span>
                </button>
                <button class="nav-item" data-category="expenses">
                    <span class="nav-icon">ğŸ’°</span>
                    <span class="nav-text">Harcamalar</span>
                </button>
            </nav>

            <!-- BugÃ¼nÃ¼n Ã–zeti Widget -->
            <div class="today-summary-widget">
                <h4>BugÃ¼nkÃ¼ GÃ¶revler</h4>
                <div class="mini-task-list" id="todayMiniTasks">
                    <div class="mini-task-empty">HenÃ¼z gÃ¶rev yok</div>
                </div>
            </div>

            <div class="sidebar-footer">
                <div class="sync-indicator" id="syncIndicator" onclick="syncManager?.manualSync()">
                    <span class="sync-dot online"></span>
                    <span>Senkronize</span>
                </div>
                <div class="status">
                    <div class="status-dot" style="background: #4CAF50;"></div>
                    <span>v3.0 - Life Manager</span>
                </div>
            </div>
        </aside>

        <!-- Sidebar Overlay (Mobil iÃ§in) -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Ana Sayfa Ä°Ã§eriÄŸi -->
            <main class="content-area" id="contentArea">
                <!-- Home Content -->
                <div class="category-content" id="content-home" style="display: block;">
                    <div class="home-dashboard">
                        <!-- HoÅŸgeldin BÃ¶lÃ¼mÃ¼ -->
                        <div class="home-header">
                            <div class="greeting">
                                <h1 id="greetingText">GÃ¼naydÄ±n!</h1>
                                <p id="dateText">3 AralÄ±k 2024, SalÄ±</p>
                            </div>
                            <button class="btn-add-quick" onclick="showQuickAddMenu(this)">
                                <span>+</span>
                            </button>
                        </div>

                        <!-- GÃ¼nÃ¼n Ã–zeti KartlarÄ± -->
                        <div class="summary-cards">
                            <div class="summary-card" onclick="categoryManager.setActive('personal')">
                                <div class="card-icon" style="background: #4ECDC4;">âœ…</div>
                                <div class="card-info">
                                    <span class="card-value" id="todayTaskCount">0</span>
                                    <span class="card-label">BugÃ¼nkÃ¼ GÃ¶rev</span>
                                </div>
                            </div>
                            <div class="summary-card" onclick="categoryManager.setActive('study')">
                                <div class="card-icon" style="background: #667eea;">ğŸ“š</div>
                                <div class="card-info">
                                    <span class="card-value" id="studyProgramCount">0</span>
                                    <span class="card-label">Ã‡alÄ±ÅŸma ProgramÄ±</span>
                                </div>
                            </div>
                            <div class="summary-card" onclick="categoryManager.setActive('health')">
                                <div class="card-icon" style="background: #FF6B6B;">ğŸ’Š</div>
                                <div class="card-info">
                                    <span class="card-value" id="healthReminderCount">0</span>
                                    <span class="card-label">SaÄŸlÄ±k HatÄ±rlatmasÄ±</span>
                                </div>
                            </div>
                        </div>

                        <!-- BugÃ¼nÃ¼n GÃ¶revleri -->
                        <div class="home-section">
                            <div class="section-header">
                                <h3>ğŸ“‹ BugÃ¼nÃ¼n GÃ¶revleri</h3>
                                <button class="btn-see-all" onclick="categoryManager.setActive('personal')">TÃ¼mÃ¼nÃ¼ GÃ¶r</button>
                            </div>
                            <div class="today-tasks-list" id="homeTodayTasks">
                                <div class="empty-state">
                                    <div class="empty-icon">ğŸ“</div>
                                    <p>BugÃ¼n iÃ§in gÃ¶rev yok</p>
                                    <button class="btn-primary" onclick="todoManager.openAddModal()">GÃ¶rev Ekle</button>
                                </div>
                            </div>
                        </div>

                        <!-- SaÄŸlÄ±k HatÄ±rlatmalarÄ± -->
                        <div class="home-section">
                            <div class="section-header">
                                <h3>ğŸ’Š SaÄŸlÄ±k HatÄ±rlatmalarÄ±</h3>
                                <button class="btn-see-all" onclick="categoryManager.setActive('health')">TÃ¼mÃ¼nÃ¼ GÃ¶r</button>
                            </div>
                            <div class="health-reminders-list" id="homeHealthReminders">
                                <div class="empty-state">
                                    <div class="empty-icon">ğŸ’Š</div>
                                    <p>HenÃ¼z ilaÃ§/vitamin eklenmedi</p>
                                    <button class="btn-primary" onclick="categoryManager.setActive('health')">Ekle</button>
                                </div>
                            </div>
                        </div>

                        <!-- YaklaÅŸan GÃ¶revler -->
                        <div class="home-section">
                            <div class="section-header">
                                <h3>ğŸ“† YaklaÅŸan</h3>
                            </div>
                            <div class="upcoming-tasks-list" id="homeUpcomingTasks">
                                <div class="empty-state mini">
                                    <p>YaklaÅŸan gÃ¶rev yok</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Study Content -->
                <div class="category-content" id="content-study" style="display: none;">
                    <div class="study-dashboard">
                        <div class="section-header">
                            <h2>ğŸ“š Ã‡alÄ±ÅŸma ProgramlarÄ±</h2>
                            <button class="btn-primary" onclick="app.showCreateProgramForm()">+ Yeni Program</button>
                        </div>
                        <div id="studyProgramsList">
                            <!-- Programlar buraya yÃ¼klenecek -->
                        </div>
                    </div>
                </div>

                <!-- Personal/TODO Content -->
                <div class="category-content" id="content-personal" style="display: none;">
                    <div class="todo-list-container" id="todoListContainer">
                        <!-- TODO listesi buraya yÃ¼klenecek -->
                    </div>
                </div>

                <!-- Health Content -->
                <div class="category-content" id="content-health" style="display: none;">
                    <div class="health-dashboard">
                        <div class="section-header">
                            <h2>ğŸ’Š SaÄŸlÄ±k Takibi</h2>
                            <button class="btn-primary" onclick="openHealthModal()">+ Ä°laÃ§/Vitamin Ekle</button>
                        </div>
                        <div class="health-content" id="healthContent">
                            <div class="empty-state">
                                <div class="empty-icon">ğŸ’Š</div>
                                <h3>SaÄŸlÄ±k Takibi</h3>
                                <p>Ä°laÃ§ ve vitamin hatÄ±rlatÄ±cÄ±larÄ±nÄ±zÄ± buradan yÃ¶netin</p>
                                <button class="btn-primary" onclick="openHealthModal()">Ä°lk Ä°lacÄ± Ekle</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Expenses Content -->
                <div class="category-content" id="content-expenses" style="display: none;">
                    <div class="expense-container">
                        <!-- Header -->
                        <div class="expense-header">
                            <h2>ğŸ’° Harcama Takibi</h2>
                            <button class="btn-primary" onclick="expenseManager?.showAddModal()">+ Harcama Ekle</button>
                        </div>

                        <!-- Streak Widget -->
                        <div class="streak-section" id="streakWidget">
                            <div class="streak-display">
                                <span class="streak-fire">ğŸ”¥</span>
                                <span class="streak-count">0</span>
                                <span class="streak-label">GÃ¼n Streak</span>
                            </div>
                            <div class="streak-milestone">Ä°lk harcamanÄ± ekleyerek baÅŸla!</div>
                        </div>

                        <!-- Budget Progress -->
                        <div class="budget-section" id="budgetProgress">
                            <div class="budget-empty">
                                <p>AylÄ±k bÃ¼tÃ§e belirlenmedi</p>
                                <button class="btn-small" onclick="expenseManager?.showBudgetModal()">BÃ¼tÃ§e Belirle</button>
                            </div>
                        </div>

                        <!-- Statistics Cards -->
                        <div class="stats-row">
                            <div class="stat-card negative">
                                <div class="stat-value" id="statExpenses">0â‚º</div>
                                <div class="stat-label">Bu Ay Gider</div>
                            </div>
                            <div class="stat-card positive">
                                <div class="stat-value" id="statIncome">0â‚º</div>
                                <div class="stat-label">Bu Ay Gelir</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="statBalance">0â‚º</div>
                                <div class="stat-label">Net Bakiye</div>
                            </div>
                        </div>

                        <!-- Charts -->
                        <div class="charts-section">
                            <div class="chart-card">
                                <h4>ğŸ“Š Kategori DaÄŸÄ±lÄ±mÄ±</h4>
                                <div class="chart-container">
                                    <canvas id="categoryChart"></canvas>
                                </div>
                            </div>
                            <div class="chart-card">
                                <h4>ğŸ“ˆ HaftalÄ±k Trend</h4>
                                <div class="chart-container">
                                    <canvas id="weeklyChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Transaction List -->
                        <div class="expense-list-section">
                            <div class="expense-list-header">
                                <h3>ğŸ“‹ Son Ä°ÅŸlemler</h3>
                                <a href="#" class="expense-view-all" onclick="expenseManager?.showAllTransactions()">TÃ¼mÃ¼nÃ¼ GÃ¶r</a>
                            </div>
                            <div id="expensesList">
                                <div class="empty-state">
                                    <span class="empty-icon">ğŸ’°</span>
                                    <p>HenÃ¼z harcama kaydÄ± yok</p>
                                    <p class="empty-hint">Ä°lk harcamanÄ± ekleyerek baÅŸla!</p>
                                </div>
                            </div>
                        </div>

                        <!-- Badges Section -->
                        <div class="badges-section">
                            <h3>ğŸ† Rozetler</h3>
                            <div class="badges-grid" id="expenseBadges">
                                <!-- Rozetler dinamik olarak yÃ¼klenecek -->
                            </div>
                        </div>
                    </div>

                    <!-- FAB Button -->
                    <button class="expense-fab" onclick="expenseManager?.showAddModal()">+</button>
                </div>
            </main>

            <!-- Detail Panel (Eski sistem iÃ§in geriye uyumluluk) -->
            <aside class="detail-panel" id="detailPanel" style="display: none;">
                <div class="detail-header">
                    <div class="detail-title">
                        <h2>ğŸ“Š Kontrol Paneli</h2>
                    </div>
                    <button class="close-detail" id="closeDetailBtn">âœ•</button>
                </div>
                <div class="detail-body">
                    <div id="panelContent"></div>
                </div>
            </aside>

            <!-- Wizard Modal -->
            <div id="wizardContainer" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; overflow-y: auto; padding: 40px 20px;">
                <!-- Wizard content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Quick Add Menu -->
    <div class="quick-add-menu" id="quickAddMenu" style="display: none;">
        <button class="quick-add-item" onclick="todoManager.openAddModal(); hideQuickAddMenu();">
            <span class="icon">âœ…</span>
            <span>GÃ¶rev Ekle</span>
        </button>
        <button class="quick-add-item" onclick="app.showCreateProgramForm(); hideQuickAddMenu();">
            <span class="icon">ğŸ“š</span>
            <span>Program OluÅŸtur</span>
        </button>
        <button class="quick-add-item" onclick="openHealthModal(); hideQuickAddMenu();">
            <span class="icon">ğŸ’Š</span>
            <span>Ä°laÃ§/Vitamin Ekle</span>
        </button>
        <button class="quick-add-item" onclick="openExpenseModal(); hideQuickAddMenu();">
            <span class="icon">ğŸ’°</span>
            <span>Harcama Ekle</span>
        </button>
    </div>

    <!-- DiÄŸer Butonu (Sol Alt KÃ¶ÅŸe) -->
    <div class="floating-menu-container" id="floatingMenuContainer">
        <button class="floating-menu-btn" id="floatingMenuBtn" onclick="toggleFloatingMenu()">
            <span class="menu-icon">â˜°</span>
        </button>
        <div class="floating-menu" id="floatingMenu">
            <button class="menu-item" onclick="settingsPanel.open(); toggleFloatingMenu();">
                <span class="icon">âš™ï¸</span>
                <span>Ayarlar</span>
            </button>
            <button class="menu-item" onclick="exportAllData(); toggleFloatingMenu();">
                <span class="icon">ğŸ“¥</span>
                <span>DÄ±ÅŸa Aktar</span>
            </button>
            <button class="menu-item" onclick="importDataDialog(); toggleFloatingMenu();">
                <span class="icon">ğŸ“¤</span>
                <span>Ä°Ã§e Aktar</span>
            </button>
            <div class="menu-divider"></div>
            <button class="menu-item" onclick="showFeedbackForm(); toggleFloatingMenu();">
                <span class="icon">ğŸ’¬</span>
                <span>Geri Bildirim</span>
            </button>
            <button class="menu-item" onclick="showHelp(); toggleFloatingMenu();">
                <span class="icon">â“</span>
                <span>YardÄ±m</span>
            </button>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-container">
            <div class="auth-header">
                <div class="auth-logo">âœ¨</div>
                <h2>Life Manager</h2>
                <p>HayatÄ±nÄ± organize etmeye baÅŸla</p>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login" onclick="authManager.switchTab('login')">GiriÅŸ Yap</button>
                <button class="auth-tab" data-tab="register" onclick="authManager.switchTab('register')">KayÄ±t Ol</button>
            </div>

            <div class="auth-content">
                <!-- Login Form -->
                <form class="auth-form active" id="loginForm" onsubmit="handleLoginSubmit(event)">
                    <div class="form-group">
                        <label for="loginEmail">E-posta</label>
                        <input type="email" id="loginEmail" placeholder="ornek@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Åifre</label>
                        <input type="password" id="loginPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                    </div>
                    <div class="forgot-password">
                        <a href="#" onclick="authManager.showResetPassword(); return false;">Åifremi unuttum</a>
                    </div>
                    <div class="auth-error"></div>
                    <button type="submit" class="btn-primary">GiriÅŸ Yap</button>
                </form>

                <!-- Register Form -->
                <form class="auth-form" id="registerForm" onsubmit="handleRegisterSubmit(event)">
                    <div class="form-group">
                        <label for="registerName">Ad Soyad</label>
                        <input type="text" id="registerName" placeholder="AdÄ±nÄ±z SoyadÄ±nÄ±z" required>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">E-posta</label>
                        <input type="email" id="registerEmail" placeholder="ornek@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Åifre</label>
                        <input type="password" id="registerPassword" placeholder="En az 6 karakter" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="registerConfirmPassword">Åifre Tekrar</label>
                        <input type="password" id="registerConfirmPassword" placeholder="Åifrenizi tekrar girin" required>
                    </div>
                    <div class="auth-error"></div>
                    <button type="submit" class="btn-primary">KayÄ±t Ol</button>
                </form>

                <!-- Reset Password Form -->
                <form class="auth-form" id="resetPasswordForm" onsubmit="handleResetPasswordSubmit(event)">
                    <div class="form-group">
                        <label for="resetEmail">E-posta</label>
                        <input type="email" id="resetEmail" placeholder="ornek@email.com" required>
                    </div>
                    <div class="auth-error"></div>
                    <button type="submit" class="btn-primary">Åifre SÄ±fÄ±rlama Linki GÃ¶nder</button>
                    <div class="back-link">
                        <a href="#" onclick="authManager.switchTab('login'); return false;">â† GiriÅŸ sayfasÄ±na dÃ¶n</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Onboarding Modal -->
    <div class="onboarding-modal" id="onboardingModal">
        <div class="onboarding-container">
            <div class="onboarding-progress">
                <div class="onboarding-progress-fill"></div>
                <span class="onboarding-progress-text">1 / 4</span>
            </div>
            <div id="onboardingContent">
                <!-- Wizard adÄ±mlarÄ± buraya render edilecek -->
            </div>
        </div>
    </div>

    <!-- Expense Modal -->
    <div class="expense-modal" id="expenseModal">
        <div class="expense-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Harcama Ekle</h3>
                <button class="modal-close" onclick="expenseManager?.hideModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="expenseForm">
                    <!-- Amount -->
                    <div class="form-group">
                        <label>Tutar</label>
                        <div class="amount-input-wrapper">
                            <input type="number" name="amount" id="expenseAmount" placeholder="0" step="0.01" required>
                            <span class="amount-currency">â‚º</span>
                        </div>
                    </div>

                    <!-- Type Toggle -->
                    <div class="form-group">
                        <label>Ä°ÅŸlem Tipi</label>
                        <div class="type-toggle">
                            <label>
                                <input type="radio" name="type" value="expense" checked>
                                <span>Gider</span>
                            </label>
                            <label>
                                <input type="radio" name="type" value="income">
                                <span>Gelir</span>
                            </label>
                        </div>
                        <input type="hidden" name="type" id="expenseType" value="expense">
                    </div>

                    <!-- Category -->
                    <div class="form-group">
                        <label>Kategori</label>
                        <div class="category-grid" id="expenseCategoryButtons">
                            <!-- Kategori butonlarÄ± dinamik olarak yÃ¼klenecek -->
                        </div>
                        <input type="hidden" name="category" id="expenseCategory" value="other">
                    </div>

                    <!-- Description -->
                    <div class="form-group">
                        <label>AÃ§Ä±klama</label>
                        <input type="text" name="description" id="expenseDescription" placeholder="Ne iÃ§in harcandÄ±?">
                    </div>

                    <!-- Date -->
                    <div class="form-group">
                        <label>Tarih</label>
                        <input type="date" name="date" id="expenseDate">
                    </div>

                    <!-- Quick Templates -->
                    <div class="quick-templates-section">
                        <div class="quick-templates-title">HÄ±zlÄ± Åablonlar</div>
                        <div class="quick-templates" id="expenseQuickTemplates">
                            <p class="templates-empty">HÄ±zlÄ± ÅŸablonlar iÃ§in harcama ekleyin</p>
                        </div>
                    </div>

                    <!-- Buttons -->
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="expenseManager?.hideModal()">Ä°ptal</button>
                        <button type="submit" class="btn-submit">Kaydet</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Budget Modal -->
    <div class="expense-modal budget-modal" id="budgetModal">
        <div class="expense-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">BÃ¼tÃ§e Ayarla</h3>
                <button class="modal-close" onclick="expenseManager?.hideBudgetModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="budgetForm">
                    <!-- Monthly Budget -->
                    <div class="form-group">
                        <label>AylÄ±k Toplam BÃ¼tÃ§e</label>
                        <div class="amount-input-wrapper">
                            <input type="number" id="monthlyBudget" placeholder="5000" step="100">
                            <span class="amount-currency">â‚º</span>
                        </div>
                    </div>

                    <!-- Category Budgets -->
                    <div class="form-group">
                        <label>Kategori BÃ¼tÃ§eleri (Opsiyonel)</label>
                        <div class="budget-category-list">
                            <div class="budget-category-item">
                                <span class="cat-icon">ğŸ”</span>
                                <label>Yemek</label>
                                <input type="number" id="budget_food" placeholder="1500">
                            </div>
                            <div class="budget-category-item">
                                <span class="cat-icon">ğŸš—</span>
                                <label>UlaÅŸÄ±m</label>
                                <input type="number" id="budget_transport" placeholder="500">
                            </div>
                            <div class="budget-category-item">
                                <span class="cat-icon">ğŸ¬</span>
                                <label>EÄŸlence</label>
                                <input type="number" id="budget_entertainment" placeholder="500">
                            </div>
                            <div class="budget-category-item">
                                <span class="cat-icon">ğŸ“„</span>
                                <label>Fatura</label>
                                <input type="number" id="budget_bills" placeholder="1000">
                            </div>
                            <div class="budget-category-item">
                                <span class="cat-icon">ğŸ›ï¸</span>
                                <label>AlÄ±ÅŸveriÅŸ</label>
                                <input type="number" id="budget_shopping" placeholder="500">
                            </div>
                            <div class="budget-category-item">
                                <span class="cat-icon">ğŸ’Š</span>
                                <label>SaÄŸlÄ±k</label>
                                <input type="number" id="budget_health" placeholder="300">
                            </div>
                            <div class="budget-category-item">
                                <span class="cat-icon">ğŸ“š</span>
                                <label>EÄŸitim</label>
                                <input type="number" id="budget_education" placeholder="200">
                            </div>
                        </div>
                    </div>

                    <!-- Buttons -->
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="expenseManager?.hideBudgetModal()">Ä°ptal</button>
                        <button type="submit" class="btn-submit">Kaydet</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase Config (Ä°lk yÃ¼klenmeli) -->
    <script src="js/core/firebase-config.js"></script>
    <script src="js/core/auth-manager.js"></script>
    <script src="js/core/onboarding-manager.js"></script>
    <script src="js/core/sync-manager.js"></script>

    <!-- Core Modules (Yeni) -->
    <script src="js/core/data-manager.js"></script>
    <script src="js/core/category-manager.js"></script>

    <!-- Features (Yeni) -->
    <script src="js/features/todo-manager.js"></script>
    <script src="js/features/health-manager.js"></script>
    <script src="js/features/expense-manager.js"></script>

    <!-- Core Modules (Mevcut) -->
    <script src="js/version.js"></script>
    <script src="js/user-manager.js"></script>
    <script src="js/resources-db.js"></script>
    <script src="js/study-tracker.js"></script>

    <!-- Features (Mevcut) -->
    <script src="js/notification-manager.js"></script>
    <script src="js/calendar-view.js"></script>
    <script src="js/program-wizard.js"></script>
    <script src="js/session-manager.js"></script>
    <script src="js/pomodoro-timer.js"></script>
    <script src="js/daily-log-viewer.js"></script>
    <script src="js/badges-system.js"></script>
    <script src="js/magnetic-tilt.js"></script>

    <!-- Update & Error Management -->
    <script src="js/error-logger.js"></script>
    <script src="js/email-notifier.js"></script>
    <script src="js/telegram-notifier.js"></script>
    <script src="js/telegram-bot.js"></script>
    <script src="js/settings-panel.js"></script>
    <script src="js/program-dashboard.js"></script>
    <script src="js/update-manager.js"></script>

    <!-- Theme Manager -->
    <script src="js/theme-manager.js"></script>

    <!-- PDF Export -->
    <script src="js/pdf-export.js"></script>

    <!-- Feedback Form -->
    <script src="js/feedback-form.js"></script>

    <!-- Main App -->
    <script src="js/app.js"></script>

    <!-- App Initialization -->
    <script>
        // Hamburger Menu Toggle
        function toggleHamburgerMenu() {
            const menu = document.getElementById('hamburgerMenu');
            const btn = document.getElementById('hamburgerMenuBtn');
            menu.classList.toggle('show');
            btn.classList.toggle('active');
        }

        document.getElementById('hamburgerMenuBtn')?.addEventListener('click', toggleHamburgerMenu);

        // Mobil Sidebar Toggle
        document.getElementById('hamburgerToggle')?.addEventListener('click', () => {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.getElementById('hamburgerToggle');
            sidebar.classList.toggle('open');
            toggle.classList.toggle('active');
        });

        document.getElementById('sidebarOverlay')?.addEventListener('click', () => {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.getElementById('hamburgerToggle');
            sidebar.classList.remove('open');
            toggle.classList.remove('active');
        });

        // Quick Add Menu
        function showQuickAddMenu(btn) {
            const menu = document.getElementById('quickAddMenu');
            const rect = btn.getBoundingClientRect();
            menu.style.top = (rect.bottom + 8) + 'px';
            menu.style.right = (window.innerWidth - rect.right) + 'px';
            menu.style.display = 'block';

            // DÄ±ÅŸarÄ± tÄ±klanÄ±nca kapat
            setTimeout(() => {
                document.addEventListener('click', hideQuickAddMenu, { once: true });
            }, 0);
        }

        function hideQuickAddMenu() {
            document.getElementById('quickAddMenu').style.display = 'none';
        }

        // Greeting gÃ¼ncelle
        function updateGreeting() {
            const hour = new Date().getHours();
            let greeting = 'Merhaba!';
            if (hour >= 5 && hour < 12) greeting = 'GÃ¼naydÄ±n!';
            else if (hour >= 12 && hour < 18) greeting = 'Ä°yi GÃ¼nler!';
            else if (hour >= 18 && hour < 22) greeting = 'Ä°yi AkÅŸamlar!';
            else greeting = 'Ä°yi Geceler!';

            const greetingEl = document.getElementById('greetingText');
            if (greetingEl) greetingEl.textContent = greeting;

            const dateEl = document.getElementById('dateText');
            if (dateEl) {
                const now = new Date();
                dateEl.textContent = now.toLocaleDateString('tr-TR', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    weekday: 'long'
                });
            }
        }

        // Navigasyon event listener'larÄ±
        document.querySelectorAll('.nav-item').forEach(btn => {
            btn.addEventListener('click', () => {
                const category = btn.dataset.category;
                categoryManager.setActive(category);

                // Mobilde sidebar'Ä± kapat
                if (window.innerWidth <= 768) {
                    document.getElementById('sidebar').classList.remove('open');
                    document.getElementById('hamburgerToggle').classList.remove('active');
                }
            });
        });

        // Ana sayfa iÃ§eriklerini gÃ¼ncelle
        function updateHomeContent() {
            updateGreeting();
            updateSummaryCards();
            updateTodayTasks();
            updateMiniTaskList();
        }

        function updateSummaryCards() {
            // GÃ¶rev sayÄ±sÄ±
            const todoCount = todoManager?.getTodayItems()?.length || 0;
            const el1 = document.getElementById('todayTaskCount');
            if (el1) el1.textContent = todoCount;

            // Program sayÄ±sÄ±
            const programs = DataManager.load(DataManager.KEYS.STUDY_PROGRAMS) || [];
            const el2 = document.getElementById('studyProgramCount');
            if (el2) el2.textContent = programs.length;

            // SaÄŸlÄ±k hatÄ±rlatmasÄ±
            const el3 = document.getElementById('healthReminderCount');
            if (el3) el3.textContent = '0'; // HenÃ¼z saÄŸlÄ±k modÃ¼lÃ¼ eklenmedi
        }

        function updateTodayTasks() {
            const container = document.getElementById('homeTodayTasks');
            if (!container || !window.todoManager) return;

            const todayItems = todoManager.getTodayItems().slice(0, 5);
            if (todayItems.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“</div>
                        <p>BugÃ¼n iÃ§in gÃ¶rev yok</p>
                        <button class="btn-primary" onclick="todoManager.openAddModal()">GÃ¶rev Ekle</button>
                    </div>
                `;
                return;
            }

            container.innerHTML = todayItems.map(item => `
                <div class="home-task-item" onclick="todoManager.toggleComplete('${item.id}'); updateHomeContent();">
                    <div class="task-checkbox ${item.completed ? 'checked' : ''}">${item.completed ? 'âœ“' : ''}</div>
                    <div class="task-info">
                        <span class="task-title">${item.title}</span>
                        ${item.dueTime ? `<span class="task-time">ğŸ• ${item.dueTime}</span>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function updateMiniTaskList() {
            const container = document.getElementById('todayMiniTasks');
            if (!container || !window.todoManager) return;

            const todayItems = todoManager.getTodayItems().slice(0, 3);
            if (todayItems.length === 0) {
                container.innerHTML = '<div class="mini-task-empty">BugÃ¼n iÃ§in gÃ¶rev yok</div>';
                return;
            }

            container.innerHTML = todayItems.map(item => `
                <div class="mini-task-item" onclick="categoryManager.setActive('personal')">
                    <div class="mini-task-dot" style="background: ${categoryManager.getColor(item.category)}"></div>
                    <span class="mini-task-text">${item.title}</span>
                    ${item.dueTime ? `<span class="mini-task-time">${item.dueTime}</span>` : ''}
                </div>
            `).join('');
        }

        // Kategori deÄŸiÅŸikliÄŸinde iÃ§erik gÃ¼ncelle
        document.addEventListener('categoryChanged', (e) => {
            const category = e.detail.category;

            if (category === 'home') {
                updateHomeContent();
            } else if (category === 'personal') {
                todoManager.renderTodoList();
            } else if (category === 'study') {
                renderStudyPrograms();
            } else if (category === 'expenses') {
                initExpenseModule();
            } else if (category === 'health') {
                initHealthModule();
            }
        });

        // Expense modÃ¼lÃ¼nÃ¼ baÅŸlat
        function initExpenseModule() {
            if (window.expenseManager) {
                expenseManager.init();
                renderExpenseCharts();
                renderExpenseBadges();
                updateExpenseStats();
            }
        }

        // Health modÃ¼lÃ¼nÃ¼ baÅŸlat
        function initHealthModule() {
            if (window.healthManager) {
                healthManager.renderAll();
            }
        }

        // Expense Charts
        let categoryChart = null;
        let weeklyChart = null;

        function renderExpenseCharts() {
            if (!window.expenseManager || typeof Chart === 'undefined') return;

            // Kategori daÄŸÄ±lÄ±mÄ± (Doughnut)
            const categoryData = expenseManager.getCategoryChartData();
            const categoryCtx = document.getElementById('categoryChart')?.getContext('2d');

            if (categoryCtx) {
                if (categoryChart) categoryChart.destroy();

                categoryChart = new Chart(categoryCtx, {
                    type: 'doughnut',
                    data: {
                        labels: categoryData.map(d => d.label),
                        datasets: [{
                            data: categoryData.map(d => d.value),
                            backgroundColor: categoryData.map(d => d.color),
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 12,
                                    padding: 8,
                                    font: { size: 11 }
                                }
                            }
                        },
                        cutout: '65%'
                    }
                });
            }

            // HaftalÄ±k trend (Bar)
            const weeklyData = expenseManager.getWeeklyTrend();
            const weeklyCtx = document.getElementById('weeklyChart')?.getContext('2d');

            if (weeklyCtx) {
                if (weeklyChart) weeklyChart.destroy();

                weeklyChart = new Chart(weeklyCtx, {
                    type: 'bar',
                    data: {
                        labels: weeklyData.map(d => d.dayName),
                        datasets: [{
                            data: weeklyData.map(d => d.total),
                            backgroundColor: 'rgba(102, 126, 234, 0.7)',
                            borderRadius: 6,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { display: false },
                                ticks: {
                                    callback: (val) => val + 'â‚º',
                                    font: { size: 10 }
                                }
                            },
                            x: {
                                grid: { display: false },
                                ticks: { font: { size: 10 } }
                            }
                        }
                    }
                });
            }
        }

        // Expense Badges
        function renderExpenseBadges() {
            if (!window.expenseManager) return;

            const container = document.getElementById('expenseBadges');
            if (!container) return;

            const badges = expenseManager.getAllBadges();

            container.innerHTML = badges.map(badge => `
                <div class="badge-item ${badge.earned ? 'earned' : ''}">
                    <span class="badge-icon">${badge.icon}</span>
                    <span class="badge-name">${badge.name}</span>
                    <span class="badge-desc">${badge.description}</span>
                </div>
            `).join('');
        }

        // Update Stats
        function updateExpenseStats() {
            if (!window.expenseManager) return;

            const stats = expenseManager.getStatistics('month');

            const expEl = document.getElementById('statExpenses');
            const incEl = document.getElementById('statIncome');
            const balEl = document.getElementById('statBalance');

            if (expEl) expEl.textContent = expenseManager.formatCurrency(stats.totalExpenses);
            if (incEl) incEl.textContent = expenseManager.formatCurrency(stats.totalIncome);
            if (balEl) balEl.textContent = expenseManager.formatCurrency(stats.netBalance);
        }

        // Ã‡alÄ±ÅŸma programlarÄ±nÄ± render et
        function renderStudyPrograms() {
            const container = document.getElementById('studyProgramsList');
            if (!container) return;

            const programs = DataManager.load(DataManager.KEYS.STUDY_PROGRAMS) || [];

            if (programs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“š</div>
                        <h3>HenÃ¼z Program Yok</h3>
                        <p>Ã‡alÄ±ÅŸma programÄ± oluÅŸturarak baÅŸla!</p>
                        <button class="btn-primary" onclick="app.showCreateProgramForm()">Program OluÅŸtur</button>
                    </div>
                `;
                return;
            }

            container.innerHTML = programs.map(program => `
                <div class="program-card" onclick="app.openDashboard()">
                    <div class="program-header">
                        <h3>${program.name || program.subject}</h3>
                        <span class="program-badge">${program.topics?.filter(t => t.completed).length || 0}/${program.topics?.length || 0}</span>
                    </div>
                    <div class="program-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${calculateProgress(program)}%"></div>
                        </div>
                        <span class="progress-text">${calculateProgress(program)}%</span>
                    </div>
                </div>
            `).join('');
        }

        function calculateProgress(program) {
            if (!program.topics || program.topics.length === 0) return 0;
            const completed = program.topics.filter(t => t.completed).length;
            return Math.round((completed / program.topics.length) * 100);
        }

        // Placeholder fonksiyonlar (sonra implement edilecek)
        function openHealthModal() {
            alert('SaÄŸlÄ±k takibi modÃ¼lÃ¼ yakÄ±nda eklenecek!');
        }

        function openExpenseModal() {
            if (window.expenseManager) {
                expenseManager.showAddModal();
            }
        }

        function exportAllData() {
            const data = DataManager.exportAll();
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `life-manager-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importDataDialog() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const data = JSON.parse(event.target.result);
                            DataManager.importAll(data);
                            alert('Veriler baÅŸarÄ±yla iÃ§e aktarÄ±ldÄ±!');
                            location.reload();
                        } catch (error) {
                            alert('GeÃ§ersiz dosya formatÄ±!');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function showFeedbackForm() {
            if (window.feedbackForm) {
                feedbackForm.open();
            } else {
                alert('Geri bildirim formu yÃ¼kleniyor...');
            }
        }

        function showHelp() {
            alert('Life Manager v3.0\n\nGÃ¼nlÃ¼k yaÅŸamÄ±nÄ±zÄ± organize edin!\n\nâ€¢ GÃ¶revler: YapÄ±lacaklarÄ± takip edin\nâ€¢ Ã‡alÄ±ÅŸma: Program oluÅŸturun\nâ€¢ SaÄŸlÄ±k: Ä°laÃ§ hatÄ±rlatÄ±cÄ±larÄ±\nâ€¢ Harcamalar: BÃ¼tÃ§e takibi');
        }

        // Sayfa yÃ¼klendiÄŸinde
        window.addEventListener('load', () => {
            setTimeout(() => {
                updateHomeContent();
                categoryManager.updateBadges();
            }, 500);
        });

        // Service Worker Registration
        if ('serviceWorker' in navigator && location.protocol !== 'file:') {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('Service Worker registered:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
